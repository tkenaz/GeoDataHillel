--create
CREATE TABLE IF NOT EXISTS governments (
                                           id serial PRIMARY KEY,
                                           name VARCHAR (255) UNIQUE NOT NULL
);

CREATE TABLE IF NOT EXISTS regions (
                                       id serial PRIMARY KEY,
                                       name VARCHAR (255) UNIQUE NOT NULL
);

CREATE TABLE IF NOT EXISTS countries (
                                         id serial PRIMARY KEY,
                                         name VARCHAR (255) UNIQUE NOT NULL,
                                         region_id INT NOT NULL,
                                         government_id INT NOT NULL,
                                         regions_num INT NOT NULL,
                                         seashore BOOL DEFAULT 'false',
                                         formation_date DATE NOT NULL,
                                         FOREIGN KEY (region_id) REFERENCES regions (id),
                                         FOREIGN KEY (government_id) REFERENCES governments (id)
);

CREATE TABLE IF NOT EXISTS cities (
                                      id serial PRIMARY KEY,
                                      name VARCHAR (255) UNIQUE NOT NULL,
                                      formation_date DATE,
                                      city_date DATE,
                                      river BOOL DEFAULT 'false',
                                      citizens_num_mln NUMERIC(5,4) NOT NULL,
                                      country_id INT NOT NULL,
                                      FOREIGN KEY (country_id) REFERENCES countries (id)
);

--insert
INSERT INTO
    governments (name)
VALUES
('meritocracy'),
('monarchy'),
('other crap')
;

INSERT INTO
    regions (name)
VALUES
('Asia'),
('Australia'),
('Europe'),
('North America'),
('South America')
;

INSERT INTO
    countries (name,
               region_id,
               government_id,
               regions_num,
               seashore,
               formation_date)
VALUES
('Singapore', 1, 1, 1, 't', '1965-08-09'),
('Australia', 2, 3, 5, 't', '1788-01-26'),
('Switzerland', 3, 3, 26, 'f' , '1848-09-12');

INSERT INTO
    cities (name,
            formation_date,
            city_date,
            river,
            citizens_num_mln,
            country_id)
VALUES
('Singapore', '1965-08-09', '1965-08-09', 'false', 5.639, 1),
('Luzern', null, null, 'false', 0.057, 3),
('Zurich', null, null, 'false', 0.428, 3);

--select
SELECT * FROM governments ORDER BY name ASC;
SELECT * FROM regions ORDER BY name DESC;
SELECT * FROM countries ORDER BY name ASC;
SELECT * FROM cities ORDER BY name DESC;

SELECT cities.name, cities.formation_date, cities.city_date, cities.river,
       countries.name, regions.name, governments.name
FROM cities
         JOIN countries ON (countries.id=cities.country_id)
         JOIN regions ON (regions.id=countries.region_id)
         JOIN governments ON (governments.id=countries.government_id);

--update
UPDATE cities
SET river = 'true'
WHERE country_id=3;

--delete
DELETE FROM cities WHERE river='false';
DROP TABLE governments, regions, countries, cities CASCADE;





